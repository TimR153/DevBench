@inherits LayoutComponentBase

<MudThemeProvider @ref="_mudThemeProvider" @bind-IsDarkMode="@_isDarkMode" Theme="_theme" />
<MudPopoverProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<MudLayout>
    <MudAppBar>
        <MudGrid Spacing="5" Justify="Justify.SpaceBetween">
            <MudItem xs="8" sm="8" md="8">
                <MudStack Row="true" Spacing="5" AlignItems="AlignItems.Center">
                    <MudLink Href="/">
                        <MudImage Src="favicon.png" Alt="App Logo" Width="40" />
                    </MudLink>
                    <MudIconButton OnClick="DrawerToggle"
                                   Icon="@Icons.Material.Rounded.Notes"
                                   Color="Color.Inherit"
                                   Edge="Edge.Start" />
                    <SearchBox />
                </MudStack>
            </MudItem>

            <MudItem xs="2" sm="2" md="2">
                <MudStack Row="true" Spacing="5" AlignItems="AlignItems.Center" Justify="Justify.FlexEnd">
                    <MudTooltip Text="GitHub Repository">
                        <MudIconButton Icon="@Icons.Custom.Brands.GitHub"
                                       Href="https://github.com/timr153/devbench"
                                       Target="_blank"
                                       Color="Color.Inherit"
                                       Edge="Edge.End" />
                    </MudTooltip>

                    <MudIconButton Icon="@DarkLightModeButtonIcon"
                                   OnClick="DarkModeToggle"
                                   Color="Color.Inherit"
                                   Edge="Edge.End" />
                </MudStack>
            </MudItem>
        </MudGrid>
    </MudAppBar>

    <MudDrawer @bind-Open="_drawerOpen" Elevation="2">
        <MudDrawerHeader>
            <MudImage Src="appLogo.png" Alt="App Logo" Class="mt-2" Width="200" />
        </MudDrawerHeader>
        <NavMenu />
    </MudDrawer>
    <MudMainContent>
        @Body
    </MudMainContent>
</MudLayout>

@code {
    private bool _drawerOpen = true;
    private bool _isDarkMode = true;
    private MudThemeProvider? _mudThemeProvider;

    MudTheme _theme = new MudTheme()
    {

        PaletteLight = new PaletteLight()
        {
            Primary = MudBlazor.Colors.Blue.Darken2,
            Secondary = MudBlazor.Colors.Blue.Accent2,
            AppbarBackground = MudBlazor.Colors.Gray.Darken1,
            DrawerBackground = MudBlazor.Colors.Gray.Lighten1,
            Background = MudBlazor.Colors.Gray.Lighten2,
            DrawerText = MudBlazor.Colors.Gray.Darken4
        },
        PaletteDark = new PaletteDark()
        {
            Primary = MudBlazor.Colors.Blue.Darken2,
            Secondary = MudBlazor.Colors.Blue.Accent4,
            TextPrimary = MudBlazor.Colors.Gray.Lighten3,
            DrawerText = MudBlazor.Colors.Gray.Lighten2
        },
        LayoutProperties = new LayoutProperties()
        {
            DrawerWidthLeft = "260px",
            DrawerWidthRight = "300px"
        }
    };


    protected override void OnInitialized()
    {
    }

    void DrawerToggle()
    {
        _drawerOpen = !_drawerOpen;
    }

    void DarkModeToggle()
    {
        _isDarkMode = !_isDarkMode;
    }

    string DarkLightModeButtonIcon => _isDarkMode ? Icons.Material.Filled.LightMode : Icons.Material.Filled.DarkMode;
}
