@page "/"
@inject NavigationManager Navigation
@inject IJSRuntime JS

<PageTitle>Dev Bench – Dein Entwickler-Toolportal</PageTitle>

<MudContainer MaxWidth="MaxWidth.ExtraLarge" Class="mx-auto px-4 py-6">
    <MudContainer MaxWidth="MaxWidth.ExtraLarge" Class="mx-auto px-4 py-6">
        <MudGrid Justify="Justify.SpaceBetween" Spacing="4" Class="mt-4">
            <MudItem xs="12" md="5" lg="5" Class="my-6 d-flex flex-column px-4 py-6">
                <MudStack Spacing="5" Justify="Justify.FlexStart" AlignItems="AlignItems.Start">
                    <MudStack Row="true" Spacing="3" AlignItems="AlignItems.Center" Justify="Justify.FlexStart" Wrap="Wrap.Wrap">
                        <MudImage Src="favicon.png" Alt="App Logo"
                                  Style="max-width: 120px; width:100%; height: auto; border-radius: 12px; filter: drop-shadow(0 4px 12px rgba(0,0,0,.2));" />
                        <MudText Typo="Typo.h3" Class="fw-bold mb-0" Style="white-space: nowrap;">
                            DEV-BENCH
                        </MudText>
                    </MudStack>

                    <MudText Typo="Typo.subtitle1" Align="Align.Start">
                        Die modulare Tool-Sammlung für deinen Entwickler-Alltag – schnell, fokussiert, offline-fähig gedacht.
                    </MudText>

                    <MudStack Row="true" Spacing="3" Justify="Justify.FlexStart" Wrap="Wrap.Wrap" Class="mt-4">
                        <MudButton Variant="Variant.Filled" Color="Color.Primary"
                                   StartIcon="@Icons.Material.Filled.GridView" Size="Size.Medium"
                                   OnClick="@(() => ScrollToId("tools"))">
                            Tools entdecken
                        </MudButton>
                        <MudButton Variant="Variant.Outlined" Color="Color.Secondary"
                                   StartIcon="@Icons.Material.Filled.Info" Size="Size.Medium"
                                   OnClick="@(() => Navigation.NavigateTo("/about"))">
                            Über Dev Bench
                        </MudButton>
                        <MudButton Variant="Variant.Outlined" Color="Color.Default"
                                   StartIcon="@Icons.Custom.Brands.GitHub" Size="Size.Medium"
                                   Href="https://github.com/timr153/devbench" Target="_blank">
                            GitHub ansehen
                        </MudButton>
                    </MudStack>

                    <MudStack Row="true" Spacing="2" Class="mt-3" Justify="Justify.FlexStart" Wrap="Wrap.Wrap">
                        <MudChip T="string" Color="Color.Secondary" Variant="Variant.Outlined"
                                 Icon="@Icons.Material.Filled.Extension">
                            Blazor WASM
                        </MudChip>
                        <MudChip T="string" Color="Color.Secondary" Variant="Variant.Outlined"
                                 Icon="@Icons.Material.Filled.Style">
                            MudBlazor
                        </MudChip>
                        <MudChip T="string" Color="Color.Secondary" Variant="Variant.Outlined"
                                 Icon="@Icons.Material.Filled.OfflineBolt">
                            Schnell & leicht
                        </MudChip>
                    </MudStack>
                </MudStack>
            </MudItem>

            <MudItem xs="12" md="7" lg="7" Class="d-flex justify-center justify-md-end">
                <MudHidden Breakpoint="Breakpoint.Sm">
                    <MudPaper Elevation="3" Class="pa-5"
                              Style="border-radius:16px; background-color: var(--mud-palette-background);">
                        <MudStack Spacing="2">
                            <MudStack Row="true" AlignItems="AlignItems.Center" Spacing="1">
                                <MudIcon Icon="@Icons.Material.Filled.Settings" />
                                <MudText Typo="Typo.h6" Class="mb-0" Style="color: var(--mud-palette-primary);">
                                    Dev Bench Tools – auf einen Blick
                                </MudText>
                            </MudStack>

                            <MudStack Row="true" Spacing="1" Wrap="Wrap.Wrap">
                                <MudChip T="string" Color="Color.Info" Variant="Variant.Outlined">JSON { }</MudChip>
                                <MudChip T="string" Color="Color.Info" Variant="Variant.Outlined">RegEx /…/</MudChip>
                                <MudChip T="string" Color="Color.Info" Variant="Variant.Outlined">UUID #</MudChip>
                                <MudChip T="string" Color="Color.Info" Variant="Variant.Outlined">Docs ⇄</MudChip>
                                <MudChip T="string" Color="Color.Info" Variant="Variant.Outlined">API ☁</MudChip>
                            </MudStack>

                            <MudPaper Elevation="0" Class="pa-3"
                                      Style="border-radius:12px; background-color: var(--mud-palette-surface);">
                                <pre style="margin:0; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, 'Liberation Mono', monospace; font-size: 1rem; line-height:1.4; color: var(--mud-palette-text-primary);">
{
    "pretty": true,
    "valid": true,
    "keys": [ "id", "name", "value" ]
}
                            </pre>
                            </MudPaper>

                            <MudStack Row="true" Spacing="2" Wrap="Wrap.Wrap">
                                <MudPaper Elevation="0" Class="pa-3"
                                          Style="border-radius:12px; background-color: var(--mud-palette-surface); flex:1;">
                                    <pre style="margin:0; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, 'Liberation Mono', monospace; font-size: 1rem; color: var(--mud-palette-text-primary);">
/^[A-Z]{2}\d{3,}$/i
                                </pre>
                                </MudPaper>
                                <MudPaper Elevation="0" Class="pa-3"
                                          Style="border-radius:12px; background-color: var(--mud-palette-surface); flex:1;">
                                    <pre style="margin:0; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, 'Liberation Mono', monospace; font-size: 1rem; color: var(--mud-palette-text-primary);">
550e8400-e29b-41d4-a716-446655440000
                                </pre>
                                </MudPaper>
                            </MudStack>

                            <MudSpacer />
                            <MudAlert Severity="Severity.Success" Variant="Variant.Outlined" Dense="true" Style="border-radius:12px;">
                                Lokal verarbeitet. Kein Versand deiner Eingaben. Kein Tracking.
                            </MudAlert>
                        </MudStack>
                    </MudPaper>
                </MudHidden>
            </MudItem>
        </MudGrid>
    </MudContainer>
    <MudContainer MaxWidth="MaxWidth.ExtraLarge" Class="mx-auto px-4 py-8">
        <MudStack Spacing="1" Class="mt-4 mb-6">
            <MudText Typo="Typo.h3" Class="fw-600">Unsere Top-Tools</MudText>
            <MudText Typo="Typo.subtitle1" Class="text-medium-emphasis">
                Schnelle Helfer für deinen Dev-Alltag – schön, schnell, offlinefähig.
            </MudText>
        </MudStack>

        <MudGrid Spacing="3" Justify="Justify.FlexStart">
            @foreach (var tool in new[]
                        {
                        new ToolTile("JSON Beautifier", "Formatiert und prüft JSON-Daten", Icons.Material.Filled.Code, "/tools/json"),
                        new ToolTile("Regex Tester", "Reguläre Ausdrücke sofort prüfen", Icons.Material.Filled.ShowChart, "/tools/regex"),
                        new ToolTile("UUID Generator", "Erzeuge eindeutige IDs", Icons.Material.Filled.EnhancedEncryption, "/tools/uuid"),
                        new ToolTile("API Docs", "Deine Schnittstellen-Dokumentation", Icons.Material.Filled.Api, "/tools/api")
                        })
            {
                <MudItem xs="12" sm="6" md="4" lg="3">
                    <MudCard Class="tool-card h-100">
                        <MudCardHeader Class="px-4 pt-4 pb-2">
                            <div class="d-flex align-center">
                                <MudIcon Icon="@tool.Icon" Size="Size.Large" Class="me-2 text-primary" />
                                <MudText Typo="Typo.h6">@tool.Name</MudText>
                            </div>
                        </MudCardHeader>

                        <MudCardContent Class="px-4 pb-2 text-medium-emphasis">
                            @tool.Description
                        </MudCardContent>

                        <MudCardActions Class="px-4 pb-4 pt-0">
                            <MudButton Color="Color.Primary" Variant="Variant.Filled" Href="@tool.Link" EndIcon="@Icons.Material.Filled.ArrowForward">
                                Starten
                            </MudButton>
                        </MudCardActions>
                    </MudCard>
                </MudItem>
            }
        </MudGrid>

        <MudPaper Class="pa-5 mt-10 faq-paper" Elevation="0" Style="border-radius:16px;">
            <MudExpansionPanels Dense="true">
                <MudExpansionPanel Text="Wie funktioniert das Toolportal?">
                    Alle Tools laufen lokal in deinem Browser und verarbeiten keine Daten extern. [web:15]
                </MudExpansionPanel>
                <MudExpansionPanel Text="Kann ich Dev Bench offline nutzen?">
                    Ja, die wichtigsten Tools sind PWA-fähig und funktionieren offline. [web:3]
                </MudExpansionPanel>
                <MudExpansionPanel Text="Gibt es einen Dark-Mode?">
                    Ja, Theme-Wechsel ist jederzeit möglich. [web:3]
                </MudExpansionPanel>
            </MudExpansionPanels>
        </MudPaper>
    </MudContainer>

    @code {
        public record ToolTile(string Name, string Description, string Icon, string Link);
    }

</MudContainer>


@code {
    private bool _isDark = false;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            var ls = await JS.InvokeAsync<string>("localStorage.getItem", "devbench:theme");
            _isDark = string.Equals(ls, "dark", StringComparison.OrdinalIgnoreCase);
            StateHasChanged();
        }
    }

    public static event Action<bool>? ThemeChanged;

    public void NavigateTo(string url) => Navigation.NavigateTo(url);

    private async Task ScrollToId(string id)
    {
        await JS.InvokeVoidAsync("eval", $"document.getElementById('{id}')?.scrollIntoView({{behavior:'smooth'}});");
    }
}
